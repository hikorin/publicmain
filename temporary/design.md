# Webアプリ設計仕様書：StockOps-YF v2.1 (財務・相関統合モデル)

## 1. システム概要
本システムは、`yfinance` ライブラリをデータソースとし、日本株（東証上場銘柄）を対象に「短期的な需給（モメンタム）」と「中期的な企業価値（ファンダメンタルズ）」を二軸で評価・監視するWebアプリケーションである。

---

## 2. 投資戦略の定義とロジック

### 2.1 短期・モメンタム戦略 (Short-term Strategy)
市場全体（日経平均）に対する感応度と、直近の過熱感からエントリー/エグジットを判定する。

* **市場感度（$\beta$値）:** * 日経平均（`^N225`）と個別銘柄の過去20日間の日次収益率を用いた回帰分析。
    * $\beta > 1.2$ を「強気トレンド追随」の条件とする。
* **テクニカル指標:**
    * **RSI (14日):** 30以下（売られすぎ・反発狙い）、80以上（買われすぎ・利確）。
    * **出来高:** 直近5日平均の1.5倍以上の急増を「資金流入」のシグナルとする。

### 2.2 中期・バリューアップ戦略 (Medium-term Strategy)
企業の「稼ぐ力」と「財務健全性」を評価し、適正株価との乖離を狙う。

| 評価カテゴリ | 指標 (yfinance Key) | 判定しきい値 |
| :--- | :--- | :--- |
| **収益性** | `returnOnEquity` (ROE) | 10% 以上 |
| **割安性** | `trailingPE` (PER) | 15倍 以下 |
| **安全性** | `totalStockholderEquity / totalAssets` | 40% 以上 |
| **成長性** | `revenueGrowth` | 前年比 +5% 以上 |

---

## 3. アプリケーション機能仕様

### F-1: 銘柄スキャナー (Scanner)
* 銘柄コードを入力すると、`yfinance` からリアルタイム価格と財務諸表を取得。
* 「短期スコア」と「中期スコア」をそれぞれ100点満点で算出し、判定結果を出力。

### F-2: ポートフォリオ・モニター (Watchlist)
* 保有銘柄の「取得単価」を登録し、現在の損益（％）を表示。
* **アラート機能:** * 損切りライン（短期 $-3\%$ / 中期 $-10\%$）到達時に強調表示。
    * ROEの低下や決算後のPER急騰など、財務上のネガティブ変化を検知。

---

## 4. データ構造 (Data Schema)

```json
{
  "stock_code": "8035.T",
  "strategy": "Medium",
  "entry_price": 42000,
  "metrics": {
    "current_beta": 1.45,
    "rsi": 45.2,
    "roe": 0.18,
    "debt_ratio": 0.35
  }
}